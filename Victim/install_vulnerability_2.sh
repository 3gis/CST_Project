#!/bin/bash

apt-get update
apt-get upgrade -y

apt install wget -y
apt install gcc -y

if apache2 -v >/dev/null 2>&1 || [ -d "/usr/local/apache" ]; then
    sudo systemctl stop apache2 2>/dev/null
    sudo apt-get remove --purge apache2 apache2-utils apache2-bin apache2.2-common -y
    sudo apt-get autoremove -y
    sudo rm -rf /etc/apache2 /usr/local/apache
fi

wget http://archive.apache.org/dist/httpd/apache_1.3.20.tar.gz
tar -xvf apache_1.3.20.tar.gz

cd apache_1.3.20
./configure --prefix=/usr/local/apache --enable-module=so
make
make install

wget https://www.modssl.org/source/mod_ssl-2.8.7-1.3.20.tar.gz
tar -xvf mod_ssl-2.8.7-1.3.20.tar.gz
cd mod_ssl-2.8.7-1.3.20
./configure --with-apache=../apache_1.3.20
make 
make install

/usr/local/apache/bin/apachectl start
